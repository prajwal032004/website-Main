{% extends "admin/base.html" %}
{% block title %}{{ 'Edit' if post else 'New' }} Blog Post{% endblock %}

{% block content %}
<div class="page-header">
  <h1>
    <i class="fas fa-{{ 'edit' if post else 'plus' }}"></i> 
    {{ 'Edit' if post else 'New' }} Blog Post
  </h1>
  <p class="text-muted">{{ 'Update' if post else 'Create a new' }} blog post</p>
</div>

<form method="POST" action="{{ url_for('admin_edit_blog', id=post.id) if post else url_for('admin_edit_blog') }}">
  <div class="row">
    <div class="col-md-8">
      <!-- Main Content -->
      <div class="card mb-4">
        <div class="card-header">
          <i class="fas fa-file-alt"></i> Post Content
        </div>
        <div class="card-body">
          <div class="mb-3">
            <label for="title" class="form-label">Title *</label>
            <input type="text" class="form-control" id="title" name="title" 
                   value="{{ post.title if post else '' }}" required 
                   placeholder="Enter post title">
          </div>
          
          <div class="mb-3">
            <label for="slug" class="form-label">Slug (URL)</label>
            <input type="text" class="form-control" id="slug" name="slug" 
                   value="{{ post.slug if post else '' }}" 
                   placeholder="post-url-slug (leave empty to auto-generate)">
            <small class="text-muted">Used in the URL. Only lowercase letters, numbers, and hyphens.</small>
          </div>
          
          <div class="mb-3">
            <label for="excerpt" class="form-label">Excerpt</label>
            <textarea class="form-control" id="excerpt" name="excerpt" 
                      rows="3" placeholder="Brief summary for preview">{{ post.excerpt if post else '' }}</textarea>
          </div>
          
          <div class="mb-3">
            <label for="content" class="form-label">Content *</label>
            <textarea class="form-control" id="content" name="content" 
                      rows="15" required placeholder="Write your blog post content here...">{{ post.content if post else '' }}</textarea>
            <small class="text-muted">Full blog post content. You can use HTML formatting.</small>
          </div>
        </div>
      </div>
    </div>
    
    <div class="col-md-4">
      <!-- Sidebar -->
      
      <!-- Publish Settings -->
      <div class="card mb-4">
        <div class="card-header">
          <i class="fas fa-cog"></i> Publish Settings
        </div>
        <div class="card-body">
          <div class="mb-3">
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" id="is_published" 
                     name="is_published" {{ 'checked' if post and post.is_published else '' }}>
              <label class="form-check-label" for="is_published">
                Published
              </label>
            </div>
            <small class="text-muted">Make this post visible to public</small>
          </div>
          
          <div class="mb-3">
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" id="is_featured" 
                     name="is_featured" {{ 'checked' if post and post.is_featured else '' }}>
              <label class="form-check-label" for="is_featured">
                Featured Post
              </label>
            </div>
            <small class="text-muted">Show in featured section</small>
          </div>
        </div>
      </div>
      
      <!-- Category & Author -->
      <div class="card mb-4">
        <div class="card-header">
          <i class="fas fa-tag"></i> Category & Author
        </div>
        <div class="card-body">
          <div class="mb-3">
            <label for="category_id" class="form-label">Category</label>
            <select class="form-select" id="category_id" name="category_id">
              <option value="">Uncategorized</option>
              {% for category in categories %}
              <option value="{{ category.id }}" 
                      {{ 'selected' if post and post.category_id == category.id else '' }}>
                {{ category.name }}
              </option>
              {% endfor %}
            </select>
          </div>
          
          <div class="mb-3">
            <label for="author" class="form-label">Author</label>
            <input type="text" class="form-control" id="author" name="author" 
                   value="{{ post.author if post else 'Admin' }}" placeholder="Author name">
          </div>
        </div>
      </div>
      
      <!-- Featured Image -->
      <div class="card mb-4">
        <div class="card-header">
          <i class="fas fa-image"></i> Featured Image
        </div>
        <div class="card-body">
          <div class="mb-3">
            <label for="featured_image" class="form-label">Image URL</label>
            <input type="url" class="form-control" id="featured_image" name="featured_image" 
                   value="{{ post.featured_image if post else '' }}" 
                   placeholder="https://example.com/image.jpg">
          </div>
          {% if post and post.featured_image %}
          <img src="{{ post.featured_image }}" class="img-fluid rounded" alt="Featured image">
          {% endif %}
        </div>
      </div>
      
      <!-- SEO & Details -->
      <div class="card mb-4">
        <div class="card-header">
          <i class="fas fa-search"></i> SEO & Details
        </div>
        <div class="card-body">
          <div class="mb-3">
            <label for="tags" class="form-label">Tags</label>
            <input type="text" class="form-control" id="tags" name="tags" 
                   value="{{ post.tags if post else '' }}" 
                   placeholder="tag1, tag2, tag3">
            <small class="text-muted">Comma-separated tags</small>
          </div>
          
          <div class="mb-3">
            <label for="meta_description" class="form-label">Meta Description</label>
            <textarea class="form-control" id="meta_description" name="meta_description" 
                      rows="2" placeholder="SEO description (max 160 characters)">{{ post.meta_description if post else '' }}</textarea>
          </div>
          
          <div class="mb-3">
            <label for="read_time" class="form-label">Read Time (minutes)</label>
            <input type="number" class="form-control" id="read_time" name="read_time" 
                   value="{{ post.read_time if post else 5 }}" min="1">
          </div>
        </div>
      </div>
      
      <!-- Actions -->
      <div class="card">
        <div class="card-body">
          <button type="submit" class="btn btn-primary w-100 mb-2">
            <i class="fas fa-save"></i> Save Post
          </button>
          <a href="{{ url_for('admin_manage_blog') }}" class="btn btn-secondary w-100">
            <i class="fas fa-times"></i> Cancel
          </a>
        </div>
      </div>
    </div>
  </div>
</form>
{% endblock %}